% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/postprocess_functions.R
\name{apply_aroma}
\alias{apply_aroma}
\title{Apply AROMA-based denoising to an fMRI image}
\usage{
apply_aroma(
  in_file,
  prefix = "a",
  mixing_file,
  noise_ics,
  overwrite = FALSE,
  log_file = NULL,
  use_R = FALSE,
  fsl_img = NULL
)
}
\arguments{
\item{in_file}{Path to the input 4D NIfTI file.}

\item{prefix}{Prefix to prepend to the output file name.}

\item{mixing_file}{Path to the MELODIC mixing matrix (e.g., \code{*_desc-MELODIC_mixing.tsv}).}

\item{noise_ics}{Vector of ICA components to regress out (usually pulled from relevant aroma_timeseries.tsv file).}

\item{overwrite}{Logical; whether to overwrite the output file if it exists.}

\item{log_file}{Optional path to a file for logging FSL command output.}

\item{use_R}{Logical; if \code{TRUE}, use an R wrapper script (\code{fsl_regfilt.R}) instead of \code{fsl_regfilt}.}

\item{fsl_img}{Optional Singularity image to execute FSL commands in a containerized environment.}
}
\value{
Path to the denoised output NIfTI file. If required files are missing, returns \code{in_file} unmodified.
}
\description{
Performs non-aggressive ICA-AROMA denoising by regressing out identified noise components
from an fMRI time series using FSL's \code{fsl_regfilt}. Falls back to an R-based wrapper script
if the standard FSL command fails due to dimensionality issues.
}
\keyword{internal}
